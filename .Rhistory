############ STEPWISE
#### FORWARD
min_mod = lm(y ~ 1, data=dat)
max_mod = formula(lm(y ~ ., data=dat))
regF = step(min_mod, direction="forward", scope=max_mod)
summary(regF)
#### BACKWARD
regB = step(lm(y ~ ., data=dat), direction = "backward")
summary(regB)
#
### READ DATA
dat = read.csv("V01.csv", sep=";")
y = dat$Y
x1 = dat$X1
x2 = dat$X2
dat = dat[-ncol(dat)]
#### CONSTRUCT REGRESSION
# [-ncol(dat)]
reg = lm(y ~ ., data=dat)
summary(reg)
# Anova
reg_anova = anova(reg)
#### RESIDUALS ANALYSIS: GAUSS-MARKOV THEOREM
res = resid(reg)
plot(res, ylim=c(mean(res)-3*sd(res), mean(res)+3*sd(res)))
abline(h=mean(res), col="red", lwd=2)
abline(h=mean(res)-sd(res), col="darkgreen")
abline(h=mean(res)+sd(res), col="darkgreen")
abline(h=mean(res)-2*sd(res), col="green")
abline(h=mean(res)+2*sd(res), col="green")
abline(h=mean(res)-3*sd(res), col="blue")
abline(h=mean(res)+3*sd(res), col="blue")
# Find outliers
get_without_outliers <- function(data, resids) {
return(subset(data, resids > mean(resids)-2*sd(resids) & resids < mean(resids)+2*sd(resids)))
}
plot_new_resids <- function(newreg, i) {
res_without_outliers = resid(newreg)
plot(res_without_outliers, main=paste("Table", i),
ylim=c(mean(res_without_outliers)-3*sd(res_without_outliers),
mean(res_without_outliers)+3*sd(res_without_outliers)))
abline(h=mean(res_without_outliers), col="red", lwd=2)
abline(h=mean(res_without_outliers)-sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)+sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)-2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)+2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)-3*sd(res_without_outliers), col="blue")
abline(h=mean(res_without_outliers)+3*sd(res_without_outliers), col="blue")
return(res_without_outliers)
}
reggress_model <- function(prev_dat, prev_y, prev_res, index) {
print(paste("Index", index))
new_dat = get_without_outliers(prev_dat, prev_res)
new_y = get_without_outliers(prev_y, prev_res)
new_reg = lm(new_y ~ ., data=new_dat)
print(paste("Removed", length(prev_y) - length(new_y), "observations."))
print(summary(new_reg))
anova_result = anova(new_reg)
print(anova_result)
print(paste("Residuals sum sq =", tail(anova_result$`Sum Sq`, 1)))
print(paste("Residuals df =", tail(anova_result$Df, 1)))
print(paste("SEE =", sqrt(tail(anova_result$`Sum Sq`,1)/tail(anova_result$Df, 1))))
new_res = plot_new_resids(new_reg, index)
return(list("new_dat" = new_dat, "new_y" = new_y, "new_res" = new_res))
}
# removing 52nd elements in all columns of dat
model1 = reggress_model(dat, y, res, 1)
# removing another outliers
model2 = reggress_model(model1$new_dat, model1$new_y, model1$new_res, 2)
model3 = reggress_model(model2$new_dat, model2$new_y, model2$new_res, 3)
model4 = reggress_model(model3$new_dat, model3$new_y, model3$new_res, 4)
model5 = reggress_model(model4$new_dat, model4$new_y, model4$new_res, 5)
model5_dat_no_x2 = model5$new_dat[,c("X1","X3","X4","X5","X6","X7","X8")]
model6 = reggress_model(model5_dat_no_x2, model5$new_y, model5$new_res, 6)
model5_dat_no_x2x5 = model5$new_dat[,c("X1","X3","X4","X6","X7","X8")]
model7 = reggress_model(model5_dat_no_x2x5, model5$new_y, model5$new_res, 7)
model5_dat_no_x2x5x7 = model5$new_dat[,c("X1","X3","X4","X6","X8")]
model8 = reggress_model(model5_dat_no_x2x5x7, model5$new_y, model5$new_res, 8)
model5_dat_no_x2x5x7x8 = model5$new_dat[,c("X1","X3","X4","X6")]
model9 = reggress_model(model5_dat_no_x2x5x7x8, model5$new_y, model5$new_res, 9)
################################################
############ NON-LINEAR MODEL
nlreg = lm(y ~ I(x1^2) + I(x2^2), data=dat)
summary(nlreg)
nlreg_anova = anova(nlreg)
nlreg_updated = lm(model9$new_y ~ I(model9$new_dat$X1^2) + I(model9$new_dat$X3^2), data=model9$new_dat)
summary(nlreg_updated)
nlreg_updated_anova = anova(nlreg_updated)
nlreg_updated_ess = sum(nlreg_updated_anova$`Sum Sq`[1:2])
logreg = lm(y ~ log10(model9$new_dat$X1), data=model9$new_dat)
summary(logreg)
logreg_anova = anova(logreg)
logreg_ess = sum(logreg_anova$`Sum Sq`)
################################################
############ STEPWISE
#### FORWARD
min_mod = lm(y ~ 1, data=dat)
max_mod = formula(lm(y ~ ., data=dat))
regF = step(min_mod, direction="forward", scope=max_mod)
summary(regF)
#### BACKWARD
regB = step(lm(y ~ ., data=dat), direction = "backward")
summary(regB)
#
### READ DATA
dat = read.csv("V01.csv", sep=";")
y = dat$Y
x1 = dat$X1
x2 = dat$X2
dat = dat[-ncol(dat)]
#### CONSTRUCT REGRESSION
# [-ncol(dat)]
reg = lm(y ~ ., data=dat)
summary(reg)
# Anova
reg_anova = anova(reg)
#### RESIDUALS ANALYSIS: GAUSS-MARKOV THEOREM
res = resid(reg)
plot(res, ylim=c(mean(res)-3*sd(res), mean(res)+3*sd(res)))
abline(h=mean(res), col="red", lwd=2)
abline(h=mean(res)-sd(res), col="darkgreen")
abline(h=mean(res)+sd(res), col="darkgreen")
abline(h=mean(res)-2*sd(res), col="green")
abline(h=mean(res)+2*sd(res), col="green")
abline(h=mean(res)-3*sd(res), col="blue")
abline(h=mean(res)+3*sd(res), col="blue")
# Find outliers
get_without_outliers <- function(data, resids) {
return(subset(data, resids > mean(resids)-2*sd(resids) & resids < mean(resids)+2*sd(resids)))
}
plot_new_resids <- function(newreg, i) {
res_without_outliers = resid(newreg)
plot(res_without_outliers, main=paste("Table", i),
ylim=c(mean(res_without_outliers)-3*sd(res_without_outliers),
mean(res_without_outliers)+3*sd(res_without_outliers)))
abline(h=mean(res_without_outliers), col="red", lwd=2)
abline(h=mean(res_without_outliers)-sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)+sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)-2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)+2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)-3*sd(res_without_outliers), col="blue")
abline(h=mean(res_without_outliers)+3*sd(res_without_outliers), col="blue")
return(res_without_outliers)
}
reggress_model <- function(prev_dat, prev_y, prev_res, index) {
print(paste("Index", index))
new_dat = get_without_outliers(prev_dat, prev_res)
new_y = get_without_outliers(prev_y, prev_res)
new_reg = lm(new_y ~ ., data=new_dat)
print(paste("Removed", length(prev_y) - length(new_y), "observations."))
print(summary(new_reg))
anova_result = anova(new_reg)
print(anova_result)
print(paste("Residuals sum sq =", tail(anova_result$`Sum Sq`, 1)))
print(paste("Residuals df =", tail(anova_result$Df, 1)))
print(paste("SEE =", sqrt(tail(anova_result$`Sum Sq`,1)/tail(anova_result$Df, 1))))
new_res = plot_new_resids(new_reg, index)
return(list("new_dat" = new_dat, "new_y" = new_y, "new_res" = new_res))
}
# removing 52nd elements in all columns of dat
model1 = reggress_model(dat, y, res, 1)
# removing another outliers
model2 = reggress_model(model1$new_dat, model1$new_y, model1$new_res, 2)
model3 = reggress_model(model2$new_dat, model2$new_y, model2$new_res, 3)
model4 = reggress_model(model3$new_dat, model3$new_y, model3$new_res, 4)
model5 = reggress_model(model4$new_dat, model4$new_y, model4$new_res, 5)
model5_dat_no_x2 = model5$new_dat[,c("X1","X3","X4","X5","X6","X7","X8")]
model6 = reggress_model(model5_dat_no_x2, model5$new_y, model5$new_res, 6)
model5_dat_no_x2x5 = model5$new_dat[,c("X1","X3","X4","X6","X7","X8")]
model7 = reggress_model(model5_dat_no_x2x5, model5$new_y, model5$new_res, 7)
model5_dat_no_x2x5x7 = model5$new_dat[,c("X1","X3","X4","X6","X8")]
model8 = reggress_model(model5_dat_no_x2x5x7, model5$new_y, model5$new_res, 8)
model5_dat_no_x2x5x7x8 = model5$new_dat[,c("X1","X3","X4","X6")]
model9 = reggress_model(model5_dat_no_x2x5x7x8, model5$new_y, model5$new_res, 9)
################################################
############ NON-LINEAR MODEL
nlreg = lm(y ~ I(x1^2) + I(x2^2), data=dat)
summary(nlreg)
nlreg_anova = anova(nlreg)
nlreg_updated = lm(model9$new_y ~ I(model9$new_dat$X1^2) + I(model9$new_dat$X3^2), data=model9$new_dat)
summary(nlreg_updated)
nlreg_updated_anova = anova(nlreg_updated)
nlreg_updated_ess = sum(nlreg_updated_anova$`Sum Sq`[1:2])
logreg = lm(y ~ I(log10(model9$new_dat$X1)), data=model9$new_dat)
summary(logreg)
logreg_anova = anova(logreg)
logreg_ess = sum(logreg_anova$`Sum Sq`)
################################################
############ STEPWISE
#### FORWARD
min_mod = lm(y ~ 1, data=dat)
max_mod = formula(lm(y ~ ., data=dat))
regF = step(min_mod, direction="forward", scope=max_mod)
summary(regF)
#### BACKWARD
regB = step(lm(y ~ ., data=dat), direction = "backward")
summary(regB)
I(log10(model9$new_dat$X1))
log10(model9$new_dat$X1)
#
### READ DATA
dat = read.csv("V01.csv", sep=";")
y = dat$Y
x1 = dat$X1
x2 = dat$X2
dat = dat[-ncol(dat)]
#### CONSTRUCT REGRESSION
# [-ncol(dat)]
reg = lm(y ~ ., data=dat)
summary(reg)
# Anova
reg_anova = anova(reg)
#### RESIDUALS ANALYSIS: GAUSS-MARKOV THEOREM
res = resid(reg)
plot(res, ylim=c(mean(res)-3*sd(res), mean(res)+3*sd(res)))
abline(h=mean(res), col="red", lwd=2)
abline(h=mean(res)-sd(res), col="darkgreen")
abline(h=mean(res)+sd(res), col="darkgreen")
abline(h=mean(res)-2*sd(res), col="green")
abline(h=mean(res)+2*sd(res), col="green")
abline(h=mean(res)-3*sd(res), col="blue")
abline(h=mean(res)+3*sd(res), col="blue")
# Find outliers
get_without_outliers <- function(data, resids) {
return(subset(data, resids > mean(resids)-2*sd(resids) & resids < mean(resids)+2*sd(resids)))
}
plot_new_resids <- function(newreg, i) {
res_without_outliers = resid(newreg)
plot(res_without_outliers, main=paste("Table", i),
ylim=c(mean(res_without_outliers)-3*sd(res_without_outliers),
mean(res_without_outliers)+3*sd(res_without_outliers)))
abline(h=mean(res_without_outliers), col="red", lwd=2)
abline(h=mean(res_without_outliers)-sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)+sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)-2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)+2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)-3*sd(res_without_outliers), col="blue")
abline(h=mean(res_without_outliers)+3*sd(res_without_outliers), col="blue")
return(res_without_outliers)
}
reggress_model <- function(prev_dat, prev_y, prev_res, index) {
print(paste("Index", index))
new_dat = get_without_outliers(prev_dat, prev_res)
new_y = get_without_outliers(prev_y, prev_res)
new_reg = lm(new_y ~ ., data=new_dat)
print(paste("Removed", length(prev_y) - length(new_y), "observations."))
print(summary(new_reg))
anova_result = anova(new_reg)
print(anova_result)
print(paste("Residuals sum sq =", tail(anova_result$`Sum Sq`, 1)))
print(paste("Residuals df =", tail(anova_result$Df, 1)))
print(paste("SEE =", sqrt(tail(anova_result$`Sum Sq`,1)/tail(anova_result$Df, 1))))
new_res = plot_new_resids(new_reg, index)
return(list("new_dat" = new_dat, "new_y" = new_y, "new_res" = new_res))
}
# removing 52nd elements in all columns of dat
model1 = reggress_model(dat, y, res, 1)
# removing another outliers
model2 = reggress_model(model1$new_dat, model1$new_y, model1$new_res, 2)
model3 = reggress_model(model2$new_dat, model2$new_y, model2$new_res, 3)
model4 = reggress_model(model3$new_dat, model3$new_y, model3$new_res, 4)
model5 = reggress_model(model4$new_dat, model4$new_y, model4$new_res, 5)
model5_dat_no_x2 = model5$new_dat[,c("X1","X3","X4","X5","X6","X7","X8")]
model6 = reggress_model(model5_dat_no_x2, model5$new_y, model5$new_res, 6)
model5_dat_no_x2x5 = model5$new_dat[,c("X1","X3","X4","X6","X7","X8")]
model7 = reggress_model(model5_dat_no_x2x5, model5$new_y, model5$new_res, 7)
model5_dat_no_x2x5x7 = model5$new_dat[,c("X1","X3","X4","X6","X8")]
model8 = reggress_model(model5_dat_no_x2x5x7, model5$new_y, model5$new_res, 8)
model5_dat_no_x2x5x7x8 = model5$new_dat[,c("X1","X3","X4","X6")]
model9 = reggress_model(model5_dat_no_x2x5x7x8, model5$new_y, model5$new_res, 9)
################################################
############ NON-LINEAR MODEL
nlreg = lm(y ~ I(x1^2) + I(x2^2), data=dat)
summary(nlreg)
nlreg_anova = anova(nlreg)
nlreg_updated = lm(model9$new_y ~ I(model9$new_dat$X1^2) + I(model9$new_dat$X3^2), data=model9$new_dat)
summary(nlreg_updated)
nlreg_updated_anova = anova(nlreg_updated)
nlreg_updated_ess = sum(nlreg_updated_anova$`Sum Sq`[1:2])
logreg = lm(model9$new_y ~ I(log10(model9$new_dat$X1)), data=model9$new_dat)
summary(logreg)
logreg_anova = anova(logreg)
logreg_ess = sum(logreg_anova$`Sum Sq`)
################################################
############ STEPWISE
#### FORWARD
min_mod = lm(y ~ 1, data=dat)
max_mod = formula(lm(y ~ ., data=dat))
regF = step(min_mod, direction="forward", scope=max_mod)
summary(regF)
#### BACKWARD
regB = step(lm(y ~ ., data=dat), direction = "backward")
summary(regB)
logreg_anova
logreg_ess
nlreg = lm(y ~ I(x1^2) + I(x2^2), data=dat)
#
### READ DATA
dat = read.csv("V01.csv", sep=";")
y = dat$Y
x1 = dat$X1
x2 = dat$X2
dat = dat[-ncol(dat)]
#### CONSTRUCT REGRESSION
# [-ncol(dat)]
reg = lm(y ~ ., data=dat)
summary(reg)
# Anova
reg_anova = anova(reg)
#### RESIDUALS ANALYSIS: GAUSS-MARKOV THEOREM
res = resid(reg)
plot(res, ylim=c(mean(res)-3*sd(res), mean(res)+3*sd(res)))
abline(h=mean(res), col="red", lwd=2)
abline(h=mean(res)-sd(res), col="darkgreen")
abline(h=mean(res)+sd(res), col="darkgreen")
abline(h=mean(res)-2*sd(res), col="green")
abline(h=mean(res)+2*sd(res), col="green")
abline(h=mean(res)-3*sd(res), col="blue")
abline(h=mean(res)+3*sd(res), col="blue")
# Find outliers
get_without_outliers <- function(data, resids) {
return(subset(data, resids > mean(resids)-2*sd(resids) & resids < mean(resids)+2*sd(resids)))
}
plot_new_resids <- function(newreg, i) {
res_without_outliers = resid(newreg)
plot(res_without_outliers, main=paste("Table", i),
ylim=c(mean(res_without_outliers)-3*sd(res_without_outliers),
mean(res_without_outliers)+3*sd(res_without_outliers)))
abline(h=mean(res_without_outliers), col="red", lwd=2)
abline(h=mean(res_without_outliers)-sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)+sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)-2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)+2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)-3*sd(res_without_outliers), col="blue")
abline(h=mean(res_without_outliers)+3*sd(res_without_outliers), col="blue")
return(res_without_outliers)
}
reggress_model <- function(prev_dat, prev_y, prev_res, index) {
print(paste("Index", index))
new_dat = get_without_outliers(prev_dat, prev_res)
new_y = get_without_outliers(prev_y, prev_res)
new_reg = lm(new_y ~ ., data=new_dat)
print(paste("Removed", length(prev_y) - length(new_y), "observations."))
print(summary(new_reg))
anova_result = anova(new_reg)
print(anova_result)
print(paste("Residuals sum sq =", tail(anova_result$`Sum Sq`, 1)))
print(paste("Residuals df =", tail(anova_result$Df, 1)))
print(paste("SEE =", sqrt(tail(anova_result$`Sum Sq`,1)/tail(anova_result$Df, 1))))
new_res = plot_new_resids(new_reg, index)
return(list("new_dat" = new_dat, "new_y" = new_y, "new_res" = new_res))
}
# removing 52nd elements in all columns of dat
model1 = reggress_model(dat, y, res, 1)
# removing another outliers
model2 = reggress_model(model1$new_dat, model1$new_y, model1$new_res, 2)
model3 = reggress_model(model2$new_dat, model2$new_y, model2$new_res, 3)
model4 = reggress_model(model3$new_dat, model3$new_y, model3$new_res, 4)
model5 = reggress_model(model4$new_dat, model4$new_y, model4$new_res, 5)
model5_dat_no_x2 = model5$new_dat[,c("X1","X3","X4","X5","X6","X7","X8")]
model6 = reggress_model(model5_dat_no_x2, model5$new_y, model5$new_res, 6)
model5_dat_no_x2x5 = model5$new_dat[,c("X1","X3","X4","X6","X7","X8")]
model7 = reggress_model(model5_dat_no_x2x5, model5$new_y, model5$new_res, 7)
model5_dat_no_x2x5x7 = model5$new_dat[,c("X1","X3","X4","X6","X8")]
model8 = reggress_model(model5_dat_no_x2x5x7, model5$new_y, model5$new_res, 8)
model5_dat_no_x2x5x7x8 = model5$new_dat[,c("X1","X3","X4","X6")]
model9 = reggress_model(model5_dat_no_x2x5x7x8, model5$new_y, model5$new_res, 9)
################################################
############ NON-LINEAR MODEL
nlreg = lm(y ~ I(x1^2) + I(x2^2), data=dat)
summary(nlreg)
nlreg_anova = anova(nlreg)
nlreg_updated = lm(model9$new_y ~ I(model9$new_dat$X1^2) + I(model9$new_dat$X3^2), data=model9$new_dat)
summary(nlreg_updated)
nlreg_updated_anova = anova(nlreg_updated)
nlreg_updated_ess = sum(nlreg_updated_anova$`Sum Sq`[1:2])
logreg = lm(model9$new_y ~ I(log10(model9$new_dat$X1)), data=model9$new_dat)
summary(logreg)
logreg_anova = anova(logreg)
logreg_ess = sum(logreg_anova$`Sum Sq`)
################################################
############ STEPWISE
#### FORWARD
min_mod = lm(y ~ 1, data=dat)
max_mod = formula(lm(y ~ ., data=dat))
regF = step(min_mod, direction="forward", scope=max_mod)
summary(regF)
#### BACKWARD
regB = step(lm(y ~ ., data=dat), direction = "backward")
summary(regB)
reg_anova
anova(model5)
anova
anova ?
q
? anova
anova(model5$new_dat)
anova(regF)
anova(regB)
anova(regB)$'Sum Sq'
anova(regB)$'Sum Sq'[:-1]
anova(regB)$'Sum Sq'[-1]
anova(regB)$'Sum Sq'[1:-1]
anova(regB)$'Sum Sq'[1:4]
anova(regB)$'Sum Sq'[1:5]
sum(anova(regB)$'Sum Sq'[1:5])
anova(regF)$'Sum Sq'[1:5]
anova(regF)
anova(regF)$'Sum Sq'[1:3]
sum(anova(regF)$'Sum Sq'[1:3])
anova(model5$new_dat)
#
### READ DATA
dat = read.csv("V01.csv", sep=";")
y = dat$Y
x1 = dat$X1
x2 = dat$X2
dat = dat[-ncol(dat)]
#### CONSTRUCT REGRESSION
# [-ncol(dat)]
reg = lm(y ~ ., data=dat)
summary(reg)
# Anova
reg_anova = anova(reg)
#### RESIDUALS ANALYSIS: GAUSS-MARKOV THEOREM
res = resid(reg)
plot(res, ylim=c(mean(res)-3*sd(res), mean(res)+3*sd(res)))
abline(h=mean(res), col="red", lwd=2)
abline(h=mean(res)-sd(res), col="darkgreen")
abline(h=mean(res)+sd(res), col="darkgreen")
abline(h=mean(res)-2*sd(res), col="green")
abline(h=mean(res)+2*sd(res), col="green")
abline(h=mean(res)-3*sd(res), col="blue")
abline(h=mean(res)+3*sd(res), col="blue")
# Find outliers
get_without_outliers <- function(data, resids) {
return(subset(data, resids > mean(resids)-2*sd(resids) & resids < mean(resids)+2*sd(resids)))
}
plot_new_resids <- function(newreg, i) {
res_without_outliers = resid(newreg)
plot(res_without_outliers, main=paste("Table", i),
ylim=c(mean(res_without_outliers)-3*sd(res_without_outliers),
mean(res_without_outliers)+3*sd(res_without_outliers)))
abline(h=mean(res_without_outliers), col="red", lwd=2)
abline(h=mean(res_without_outliers)-sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)+sd(res_without_outliers), col="darkgreen")
abline(h=mean(res_without_outliers)-2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)+2*sd(res_without_outliers), col="green")
abline(h=mean(res_without_outliers)-3*sd(res_without_outliers), col="blue")
abline(h=mean(res_without_outliers)+3*sd(res_without_outliers), col="blue")
return(res_without_outliers)
}
reggress_model <- function(prev_dat, prev_y, prev_res, index) {
print(paste("Index", index))
new_dat = get_without_outliers(prev_dat, prev_res)
new_y = get_without_outliers(prev_y, prev_res)
new_reg = lm(new_y ~ ., data=new_dat)
print(paste("Removed", length(prev_y) - length(new_y), "observations."))
print(summary(new_reg))
anova_result = anova(new_reg)
print(anova_result)
print(paste("Residuals sum sq =", tail(anova_result$`Sum Sq`, 1)))
print(paste("Residuals df =", tail(anova_result$Df, 1)))
print(paste("SEE =", sqrt(tail(anova_result$`Sum Sq`,1)/tail(anova_result$Df, 1))))
new_res = plot_new_resids(new_reg, index)
return(list("new_dat" = new_dat, "new_y" = new_y, "new_res" = new_res, "anova_res" = anova_result))
}
# removing 52nd elements in all columns of dat
model1 = reggress_model(dat, y, res, 1)
# removing another outliers
model2 = reggress_model(model1$new_dat, model1$new_y, model1$new_res, 2)
model3 = reggress_model(model2$new_dat, model2$new_y, model2$new_res, 3)
model4 = reggress_model(model3$new_dat, model3$new_y, model3$new_res, 4)
model5 = reggress_model(model4$new_dat, model4$new_y, model4$new_res, 5)
model5_dat_no_x2 = model5$new_dat[,c("X1","X3","X4","X5","X6","X7","X8")]
model6 = reggress_model(model5_dat_no_x2, model5$new_y, model5$new_res, 6)
model5_dat_no_x2x5 = model5$new_dat[,c("X1","X3","X4","X6","X7","X8")]
model7 = reggress_model(model5_dat_no_x2x5, model5$new_y, model5$new_res, 7)
model5_dat_no_x2x5x7 = model5$new_dat[,c("X1","X3","X4","X6","X8")]
model8 = reggress_model(model5_dat_no_x2x5x7, model5$new_y, model5$new_res, 8)
model5_dat_no_x2x5x7x8 = model5$new_dat[,c("X1","X3","X4","X6")]
model9 = reggress_model(model5_dat_no_x2x5x7x8, model5$new_y, model5$new_res, 9)
################################################
############ NON-LINEAR MODEL
nlreg = lm(y ~ I(x1^2) + I(x2^2), data=dat)
summary(nlreg)
nlreg_anova = anova(nlreg)
nlreg_updated = lm(model9$new_y ~ I(model9$new_dat$X1^2) + I(model9$new_dat$X3^2), data=model9$new_dat)
summary(nlreg_updated)
nlreg_updated_anova = anova(nlreg_updated)
nlreg_updated_ess = sum(nlreg_updated_anova$`Sum Sq`[1:2])
logreg = lm(model9$new_y ~ I(log10(model9$new_dat$X1)), data=model9$new_dat)
summary(logreg)
logreg_anova = anova(logreg)
logreg_ess = sum(logreg_anova$`Sum Sq`)
################################################
############ STEPWISE
#### FORWARD
min_mod = lm(y ~ 1, data=dat)
max_mod = formula(lm(y ~ ., data=dat))
regF = step(min_mod, direction="forward", scope=max_mod)
summary(regF)
#### BACKWARD
regB = step(lm(y ~ ., data=dat), direction = "backward")
summary(regB)
model5$anova_res
model5$anova_res$`Sum Sq`
model5$anova_res$`Sum Sq`[1:8]
sum(model5$anova_res$`Sum Sq`[1:8])
sum(model9$anova_res$`Sum Sq`[1:4])
model9$anova_res$`Sum Sq`[1:4]
model9$anova_res
